{% extends "base/form_view_base_middleware.html" %}
{% load i18n bootstrap3 %}

{% block meta_title %}
    {% trans "Order Results" %}
    {{ orders.number }} {{ orders.patient.name }}
{% endblock %}

{% block title %}
    {% trans "Orders" %}
{% endblock %}

{% block breadcrumb_menu %}
    <li class="active"><a href="{% url 'orders' %}">{% trans "Orders" %}</a></li>
    <li class="active">{% if orders %}{% trans "Edit order results" %}{% else %}{% trans "Create order results" %}{% endif%} </li>
{% endblock %}

{% block main_header %}
    {% if orders %}{% trans "Edit order results" %}{% else %}{% trans "Create order results" %}{% endif%}
    <br>{{ orders.number }} <br>{{ orders.patient.name }}
{% endblock %}
<form method="post">
{% csrf_token %}

{% block main_toolbar %}
    <button type='submit' class='btn btn-primary'>
        {% trans "Save" %}
    </button>

    <button type="button" class="btn btn-default"
            onclick="window.location.assign('{% url 'orders' %}')">
        {% trans "Cancel" %}
    </button>
{% endblock %}

{% block main_inner %}
<style>
.form-control-ok {
  color:  red;
}
</style>
<table class="table table-responsive table-hover">
	<thead>
		<tr>
			<th>&nbsp;&nbsp;</th>
			<th>Name</th>
			<th>Result</th>
			<th>Unit</th>
			<th>Ref.Range</th>
			<th>Mark</th>
		</tr>
	</thead>
	
	<tbody>
    {% for o in ordertests %}
	    <tr>
	    	{% if o.is_header %}
	    	<td></td>
	    	<td colspan="2"><strong>{{ o.test__name }}</strong></td>
	    	{% else %}
	     	<td>	
	     	<div class='progress progress-striped'>
	     		{% if o.validation_status == 0 %}
                	<div class="progress-bar progress-bar-danger" role="progressbar" style="width: 20%;">
                {% endif %}
                {% if o.validation_status == 1 %}
                	<div class="progress-bar progress-bar-warning" role="progressbar" style="width: 40%;">
                {% endif %}
                {% if o.validation_status == 2 %}
                	<div class="progress-bar progress-bar-success" role="progressbar" style="width: 60%;">
                {% endif %}
                {% if o.validation_status == 3 %}
                	<div class="progress-bar progress-bar-info" role="progressbar" style="width: 80%;">
                {% endif %}
                {% if o.validation_status == 4 %}
                	<div class="progress-bar progress-bar-info" role="progressbar" style="width: 100%;">
                {% endif %}
                </div>
            </div>
			</td>
	     	<td>{{ o.test__name }}</td>
	     	
	     	{% endif %}
	     	<td>
	     	{% if not o.is_header %}
	     	{% if  o.test__result_type  == 'ALF' %}<input type="text" name="test_{{ o.test_id }}" class="form-control form-control-ok"   value="{{ o.result__alfa_result|default:"" }}" />{% endif %}
	     	{% if  o.test__result_type  == 'NUM' %}<input type="text" name="test_{{ o.test_id }}" class="form-control {% if o.result__mark and o.result__mark != '' %} form-control-ok {% endif %}" value="{{ o.result__alfa_result|default:"" }}" />{% endif %}
	     	{% if  o.test__result_type  == 'TXT' %}<textarea name="test_{{ o.test_id }}" class="form-control text-danger has-warning" id="" cols="45" rows="10"></textarea> {% endif %}
	     	</td>
	     	<td>{{ o.unit|default:"" }}</td>
	     	<td>{{ o.result__ref_range|default:"" }}</td>
	     	<td>{{ o.result__mark|default:"" }}</td>
	     	{% endif %}
	     	
	     	
	     </tr> 
    {% endfor %}
    </tbody>
</table>

{% endblock %}

{% block main_footer %}
    <button type='submit' class='btn btn-primary'>
        {% trans "Save" %}
    </button>

    <button type="button" class="btn btn-default"
            onclick="window.location.assign('{% url 'orders' %}')">
        {% trans "Cancel" %}
    </button>
    </form>
{% endblock %}